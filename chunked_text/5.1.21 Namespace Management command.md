
**Namespace Management command**


The Namespace Management command is used to manage namespaces (refer to section 8.1.15), including
create and delete operations.


Note: The controller continues to execute commands submitted to I/O Submission Queues while this
operation is in progress.


If the Namespace Management command supported, then the Namespace Attachment command (refer to
section 5.1.20) shall also be supported. The Namespace Management command shall not be supported by
controllers in an Exported NVM subsystem.


The host uses the Namespace Attachment command to attach or detach a namespace to or from a
controller. The create operation does not attach the namespace to a controller. As a side effect of the delete
operation, the namespace is detached from all controllers as the namespace is no longer present in the
system. It is recommended that host software detach all controllers from a namespace prior to deleting the
namespace. If the namespace is not detached from all controllers prior to being deleted, then Attached
Namespace Attribute Changed asynchronous events are reported as specified in section 8.1.15.2. If a
namespace is deleted, then Allocated Namespace Attribute Changed asynchronous events are reported
as specified in section 8.1.15.2.


The data structure used for the create operation is defined in Figure 370 and the CSI field specifies the I/O
Command Set specification. There is no data structure transferred for the delete operation.


The Namespace Management command uses the Data Pointer, Command Dword 10, and Command
Dword 11 fields. All other command specific fields are reserved.


The Namespace Identifier (NSID) field is used as follows for create and delete operations:


  - **Create:** The NSID field is reserved for this operation; host software clears this field to a value of
0h. The controller shall select an available Namespace Identifier to use for the operation; or

  - **Delete:** This field specifies the previously created namespace to delete in this operation. Specifying
a value of FFFFFFFFh is used to delete all namespaces in the NVM subsystem. If the value of
FFFFFFFFh is specified and there are zero valid namespaces, the command completes
successfully.


**Figure 367: Namespace Management – Data Pointer**





|Bits|Description|
|---|---|
|127:00|**Data Pointer (DPTR):**This field specifies the start of the data buffer. Refer to Figure 92 for the definition<br>of this field. If using PRPs, this field shall not be a pointer to a PRP List as the data buffer may not cross<br>more than one page boundary.|


**Figure 368: Namespace Management – Command Dword 10**




|Bits|Description|
|---|---|
|31:04|Reserved|



360


NVM Express [®] Base Specification, Revision 2.2


**Figure 368: Namespace Management – Command Dword 10**





|Bits|Description|
|---|---|
|03:00|**Select (SEL):**This field selects the type of management operation to perform.<br>**Value**<br>**Definition**<br>0h<br>Create<br>1h<br>Delete<br>2h to Fh<br>Reserved|


|Value|Definition|
|---|---|
|0h|Create|
|1h|Delete|
|2h to Fh|Reserved|


**Figure 369: Namespace Management – Command Dword 11**









|Bits|Description|
|---|---|
|31:24|**Command Set Identifier (CSI):** For a create operation (i.e., SEL 0h), this field specifies the I/O<br>Command Set for the created namespace. A CSI value of 0h creates a namespace using the NVM<br>Command Set. For all other operations this field is reserved.<br>Values for this field are defined by Figure 312.|
|23:0|Reserved|


**Figure 370: Namespace Management – Data Structure for Create**

|Bytes|Description|
|---|---|
|511:00|**Specific to the I/O Command Set (SIOCS):** Refer to the Namespace Management command<br>section of the applicable I/O Command Set specification.|
|1023:512|Reserved|
|4095:1024|**Vendor Specific (VS)**|



**Command Completion**


When the command is completed, the controller posts a completion queue entry to the Admin Completion
Queue indicating the status for the command.


Namespace Management command specific status values (i.e., SCT field set to 1h) are shown in Figure
371.


**Figure 371: Namespace Management – Command Specific Status Values**







|Value|Definition|
|---|---|
|0Ah|**Invalid Format:** The User Data Format specified is not supported. This may be due to various<br>conditions, including:<br>1)<br>specifying an invalid User Data Format number;<br>2)<br>enabling protection information when there are not sufficient resources (e.g., metadata per<br>LBA); or<br>3)<br>the specified format is not available in the current configuration.|
|15h|**Namespace Insufficient Capacity:**Creating the namespace requires more unallocated capacity than<br>is currently available. The Command Specific Information field in the Error Information Log Entry data<br>structure (refer to Figure 206) specifies the total amount of unallocated NVM capacity required to create<br>the namespace in bytes.|
|16h|**Namespace Identifier Unavailable:**The number of namespaces supported has been exceeded.|
|1Bh|**Thin Provisioning Not Supported:**Thin provisioning is not supported by the controller.|


361


NVM Express [®] Base Specification, Revision 2.2


**Figure 371: Namespace Management – Command Specific Status Values**







|Value|Definition|
|---|---|
|24h|**ANA Group Identifier Invalid:** The specified ANA Group Identifier (ANAGRPID) is not supported in<br>the submitted command. This may be due to various conditions, including:<br>a)<br>specifying an ANAGRPID that does not exist;<br>b)<br>the controller does not allow an ANAGRPID to be specified (i.e., the ANA Group ID Support<br>(ANAGIDS) bit in the ANACAP field is cleared to ‘0’); or<br>c)<br>the specified ANAGRPID is not supported by the controller processing the command (e.g.,<br>the specified value exceeds ANAGRPMAX (refer to Figure 313)).<br>If the host specified a non-zero ANAGRPID, retrying the command with the ANAGRPID field cleared<br>to 0h may succeed.|
|29h|**I/O Command Set Not Supported:** The I/O Command Set specified for a create operation is not<br>supported by the controller.|


Dword 0 of the completion queue entry contains the Namespace Identifier created. The definition of Dword
0 of the completion queue entry is in Figure 372.


**Figure 372: Namespace Management – Completion Queue Entry Dword 0**

|Bits|Description|
|---|---|
|31:00|**Namespace Identifier (NSID):**This field specifies the namespace identifier created in a Create<br>operation. This field is reserved for all other operations.|

