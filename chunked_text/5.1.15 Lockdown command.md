**Lockdown command**


The Lockdown command is used to control the Command and Feature Lockdown capability (refer to section
8.1.5) which configures the prohibition or allowance of execution of the specified command or Set Features
command targeting a specific Feature Identifier.


After a successful completion of a Lockdown command prohibiting a command or Feature Identifier, all
controllers, if applicable, and all management endpoints, if applicable, in the NVM subsystem behave as
described in section 8.1.5.


The Lockdown command uses Command Dword 10 (refer to Figure 338) and Command Dword 14 (refer
to Figure 339). All other command specific fields are reserved.


**Figure 338: Lockdown – Command Dword 10**





|Bits|Description|
|---|---|
|31:16|Reserved|
|15:08|**Opcode or Feature Identifier (OFI):**This field specifies the command opcode or Set Features Feature<br>Identifier identified by the Scope field.|
|07|Reserved|
|06:05|**Interface (IFC)**: This field identifies the interfaces affected by this command. The actions of this command<br>apply if a command is received on the specified interfaces.<br>**Value**<br>**Affected Interfaces**<br>00b<br>Admin Submission Queue<br>01b<br>Admin Submission Queue and out-of-band on a Management Endpoint<br>10b<br>Out-of-band on a Management Endpoint<br>11b<br>Reserved|
|04|**Prohibit (PRHBT):**This bit specifies whether to prohibit or allow the command opcode or Set Features<br>Feature Identifier specified by this command. If this bit is set to ‘1’, then this command prohibits the<br>execution of the command based on other fields specified in Dword 10. If this bit is cleared to ‘0’, then this<br>command allows the execution of the command based on other fields specified in Dword 10.|


|Value|Affected Interfaces|
|---|---|
|00b|Admin Submission Queue|
|01b|Admin Submission Queue and out-of-band on a Management Endpoint|
|10b|Out-of-band on a Management Endpoint|
|11b|Reserved|


345


NVM Express [®] Base Specification, Revision 2.2


**Figure 338: Lockdown – Command Dword 10**






|Bits|Description|
|---|---|
|03:00|**Scope (SCP):**This field specifies the contents of the Opcode or Feature Identifier field.<br>**Value**<br>**Opcode or Feature Identifier Definition**<br>0h<br>Admin command opcode<br>1h<br>Reserved<br>2h<br>A Set Features Feature Identifier<br>3h<br>Management Interface Command Set opcode (refer to the NVM Express Management<br>Interface Specification)<br>4h<br>PCIe Command Set opcode (refer to the NVM Express Management Interface Specification)<br>5h-Fh<br>Reserved|


|Value|Opcode or Feature Identifier Definition|
|---|---|
|0h|Admin command opcode|
|1h|Reserved|
|2h|A Set Features Feature Identifier|
|3h|Management Interface Command Set opcode (refer to the NVM Express Management<br>Interface Specification)|
|4h|PCIe Command Set opcode (refer to the NVM Express Management Interface Specification)|
|5h-Fh|Reserved|



If the controller supports selection of a UUID:


a) by the Lockdown command; and
b) by the Set Features command (refer to section 5.1.25 and section 8.1.28) and for the vendor

specific Feature Identifier specified by the Opcode or Feature Identifier field, if the Scope field is
set to 2h,


then Command Dword 14 (refer to Figure 339) is used to specify a UUID Index value.


If the controller does not support selection of a UUID:


a) by the Lockdown command;
b) by the Set Features command; or
c) for the vendor specific feature identifier specified by the Opcode or Feature Identifier field, if the

Scope field is set to 2h,


then Command Dword 14 does not specify a UUID Index value. If the Scope field is not set to 2h, then
UUID Index field is ignored.


**Figure 339: Lockdown – Command Dword 14**

|Bits|Description|
|---|---|
|31:07|Reserved|
|06:00|**UUID Index (UIDX):**Refer to Figure 659.|



If a controller processes this command specifying a command opcode or Feature Identifier that is not
supported as being prohibitable, then the command shall be aborted with a status code of Prohibition of
Command Execution Not Supported.


If a controller processes this command with the Interface field set to 01b or 10b and the NVM subsystem
does not contain a Management Endpoint, then the command shall be aborted with a status code of Invalid
Field in Command.


If a controller processes this command with the Interface field set to 00b or 01b and the Scope field is set
to 4h, then the command shall be aborted with a status code of Invalid Field in Command.


It is not an error to attempt to prohibit a command or Feature Identifier that is already prohibited from
execution or allow a command or Feature Identifier that is already allowed to be executed.


**Command Completion**


Upon completion of the Lockdown command, the controller posts a completion queue entry to the Admin
Completion Queue.


Lockdown command specific status values are defined in Figure 340.


346


NVM Express [®] Base Specification, Revision 2.2


**Figure 340: Lockdown – Command Specific Status Values**

|Value|Description|
|---|---|
|28h|**Prohibition of Command Execution Not Supported:**The command was aborted due to the specified<br>opcode or Feature Identifier not supporting being prohibited from execution by the command.|
