**Migration Send command**


The Migration Send command is used to manage the migration of a controller (refer to section 8.1.12).


The Migration Send command uses the Command Dword 10 and Command Dword 14. The use of the
Data Pointer field, Command Dword 11 field, Command Dword 12 field, Command Dword 13 field, and
Command Dword 15 field is specific to the management operation specified by the Select field . All other
command specific fields are reserved.


The Select field defined in Figure 350 specifies the management operation to be performed. Refer to section
5.1.17.1 for a description of each management operation.


**Figure 350: Migration Send – Command Dword 10**






|Bits|Description|
|---|---|
|31:16|**Management Operation Specific (MOS):**The definition of this field is specific to a management operation<br>(refer to the Select field). If a management operation does not define the use of this field, then this field is<br>reserved.|
|15:08|Reserved|
|07:00|**Select (SEL):**This field specifies the type of management operation to perform.<br>**Value**<br>**M/O1 **<br>**Management Operation**<br>**Reference Section**<br>0h<br>M <br>Suspend <br>5.1.17.1.1<br>1h<br>M <br>Resume<br>5.1.17.1.2<br>2h<br>M <br>Set Controller State<br>5.1.17.1.3<br>3h to FFh<br> <br>Reserved<br>Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|


|Value|1<br>M/O|Management Operation|Reference Section|
|---|---|---|---|
|0h|M|Suspend|5.1.17.1.1|
|1h|M|Resume|5.1.17.1.2|
|2h|M|Set Controller State|5.1.17.1.3|
|3h to FFh||Reserved|Reserved|
|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|



If the controller supports selection of a UUID by the Migration Send command (refer to Figure 211 and
section 8.1.28), then Command Dword 14 is used to specify a UUID Index value (refer to Figure 351).


**Figure 351: Migration Send – Command Dword 14**

|Bits|Description|
|---|---|
|31:07|Reserved|
|06:00|**UUID Index (UIDX):** Refer to Figure 659.|



**Migration Send Management Operations**


**5.1.17.1.1 Suspend (Management Operation 0h)**


The Suspend management operation of the Migration Send command allows a host to specify the type of
suspend to be done on the specified controller.


350


NVM Express [®] Base Specification, Revision 2.2


The Suspend management operation uses the Command Dword 11 field as defined in Figure 352 and does
not use the Management Operation Specific field.


**Figure 352: Suspend – Command Dword 11**






|Value|Definition|
|---|---|
|0h|**Suspend Notification:** The specified controller is going to besuspended in the future with<br>a subsequent Migration Send command specifying a Suspend management operation and<br>a non-zero value in the Suspend Type field.|
|1h|**Suspend:** Suspend the controller specified in the CNTLID field as defined in this section.|
|All Others|Reserved|



|Bits|Description|
|---|---|
|31|**Delete User Data Migration Queue (DUDMQ):**If this bit is set to ‘1’ and the command completes<br>successfully, then the User Data Migration Queue associated with the controller specified in the CNTLID<br>field, if any, is deleted (refer to the applicable I/O Command Set specification). If this bit is cleared to ‘0’,<br>then the User Data Migration Queue associated the controller specified in the CNTLID field is retained after<br>processing the command, if any.|
|30:24|Reserved|
|23:16|**Suspend Type (STYPE):**This field specifies the type of suspend.<br>**Value**<br>**Definition**<br>0h<br>**Suspend Notification:** The specified controller is going to besuspended in the future with<br>a subsequent Migration Send command specifying a Suspend management operation and<br>a non-zero value in the Suspend Type field.<br>1h<br>**Suspend:** Suspend the controller specified in the CNTLID field as defined in this section.<br>All Others<br>Reserved|
|15:00|**Controller Identifier (CNTLID):** This field specifies the identifier of the controller to which the Suspend<br>management operation is performed.|


A Suspend Type field value of 0h (i.e., Suspend Notification) allows a host to notify a controller that the
controller specified by the Controller Identifier field is going to be requested to suspend with a subsequent
Migration Send command specifying a Suspend management operation and a non-zero value in the
Suspend Type field.


A Suspend Type field value of 1h (i.e., Suspend) specifies that the controller specified in the Controller
Identifier field (refer to Figure 352) is to be suspended. That controller shall perform the following actions
and then stop initiating transport transactions:


1. Stop fetching commands until the specified controller is no longer suspended (refer to section

8.1.12).
2. Complete the processing of all previously fetched commands, if any, except any outstanding

Asynchronous Event Request commands.


If:


   - the command causes the specified controller to be suspended; and

   - there is a User Data Migration Queue associated with that specified controller,


then:


  - If the DUDMQ bit is set to ‘1’, then the controller processing the command before posting the
completion queue entry to the command shall delete that User Data Migration Queue; and

  - after the specified controller completes the processing of all previously fetched commands, if any,
except any outstanding Asynchronous Event Request commands, the controller processing the
Migration Send command shall, at a vendor specific amount of time, posts an entry in that User
Data Migration Queue that indicates the specified controller is suspended as specified by the
applicable I/O Command Set specification.


It is not an error if a suspend operation occurs on a controller that is already suspended with the same
Suspend Type value.


If the result of this command causes the specified controller to be suspended, then the specified controller
remains suspended until:


  - a Migration Send command specifying the Resume management operation (refer to section
5.1.17.1.2) on the specified controller is completed successfully; or

  - a Controller Level Reset occurs on the controller processing this command.


351


NVM Express [®] Base Specification, Revision 2.2


If a controller is suspended, then:


  - accesses to controller properties for that suspended controller shall behave normally except a host
modification of the CC property that sets CC.EN bit from ‘0’ to ‘1’ (i.e., enabling that suspended
controller) has implementation specific behavior (i.e., the suspended controller may or may not set
the CSTS.RDY bit). A host should avoid modifications to controller properties, CMB, and PMR to a
controller that is suspended;

  - the Controller Memory Buffer (CMB), if supported, shall behave as defined in section 8.2.1 (i.e.,
CMB on a suspended controller continues to function normally); and

  - the Persistent Memory Region (PMR), if supported, shall behave as defined in section 8.2.4 (i.e.,
PMR on a suspended controller continues to function normally).


**5.1.17.1.2 Resume (Management Operation 1h)**


The Resume management operation of the Migration Send command is a request for the controller
processing the command to resume the operation of a different controller that is suspended (refer to section
5.1.17.1.1).


The Resume management operation uses the Command Dword 11 field as defined in Figure 353 and does
not use the Management Operation Specific field.


**Figure 353: Resume – Command Dword 11**

|Bits|Description|
|---|---|
|31:16|Reserved|
|15:00|**Controller Identifier (CNTLID):** This field specifies the identifier of the controller to resume operations.|



The Resume management operation shall cause the controller specified by the Controller Identifier field
(refer to Figure 352) to start fetching and processing commands.


If the specified controller is not suspended (refer to section 5.1.17.1.1), then the controller shall abort the
command with a status code of Controller Not Suspended.


If the controller processing the command has received controller state for the specified controller to be
resumed and that controller state has not been verified and committed (refer to section 5.1.17.1.3), then
the controller shall abort the command with a status code of Command Sequence Error.


**5.1.17.1.3 Set Controller State (Management Operation 2h)**


The Set Controller State management operation of the Migration Send command allows the host to set the
state of the controller specified by the Controller Identifier (CNTLID) field in Command Dword 11 (refer to
Figure 355).


The data buffer contains the Controller State data structure specified in Figure 359 which specifies the state
to be set in the specified controller.


To set the controller state of the specified controller, the specified controller is required to be in one or more
of these conditions:


   - Suspended (refer to section 5.1.17.1.1);

   - enabled (i.e., CC.EN bit is set to ‘1’); or

   - offline, if that specified controller is a secondary controller.


If the specified controller is not in one of these conditions, then the controller processing the command shall
abort the command with a status code of Invalid Controller Identifier.


The host may submit one or more Migration Send commands to transfer the controller state. If more than
one Migration Send command is submitted to transfer the controller state, then:


  - The host first submits a Migration Send command with:


`o` the Select field set to Set Controller State (i.e., 2h);


352


NVM Express [®] Base Specification, Revision 2.2


`o` the Sequence Indicator (SEQIND) field (refer to Figure 354) set to 01b; and
`o` the Controller Identifier field set to the controller whose state is being set,


to specify to the controller that the command is the first of a sequence of Migration Send commands
of controller state data being transferred.

  - The host may submit Migration Send commands with:


`o` the Select field set to Set Controller State (i.e., 2h);
`o` the SEQIND field cleared to 00b; and
`o` the Controller Identifier field set to the controller whose state is being set,


to specify to the controller that the command is not the last of the sequence of Migration Send
commands of controller state data being transferred, if any.

  - The host is required to wait for the completion queue entries to be posted for the previous submitted
Migration Send commands in the sequence of Migration Send commands.

  - Finally, the host submits the last Migration Send command with:


`o` the Select field set to Set Controller State (i.e., 2h);
`o` the SEQIND field set to 10b; and
`o` the Controller Identifier field set to the controller whose state is being set,


to specify to the controller that this is the last command of the sequence of Migration Send commands of
the controller state data being transferred. This last Migration Send command may or may not have the
Number of Dwords (NUMD) field cleared to 0h.


If a sequence of Migration Send commands of the controller state data being transferred and the controller
processes a Migration Send command with:


  - the Select field set to Set Controller State (i.e., 2h);

  - the Sequence Indicator (SEQIND) field (refer to Figure 354) set to 01b; and

  - the Controller Identifier field set to the controller whose state is being set,


then, the command is specifying a new sequence of Migration Send commands of the controller state data
is being transferred and the previous sequence of Migration Send commands of the controller state data is
discarded.


If a sequence of Migration Send commands of the controller state data is not being transferred to the
specified controller and the controller processes a Migration Send command with the Sequence Indicator
(SEQIND) field (refer to Figure 354) not set to 01b, clearer to 0b; the controller shall abort that command
with a status code of Command Sequence Error.


If a single Migration Send command is submitted to transfer the entire controller state, then the host submits
a Migration Send command with the SEQIND field set to 11b.


353


NVM Express [®] Base Specification, Revision 2.2


**Figure 354:** **Set Controller State – Management Operation Specific Field**













|Bits|Description|
|---|---|
|15:02|Reserved|
|01:00|**Sequence Indicator (SEQIND):** This field identified the sequences of this Migration Send command in<br>relation to other Migration Send commands.<br>**Value**<br>**Definition**<br>00b<br>This command is not the first or last of a sequence of two or more Migration Send commands<br>with this management operation used to transfer the controller state from the host to the<br>controller.<br>01b<br>This command is the first of a sequence of two or more Migration Send commands with this<br>management operation used to transfer the controller state from the host to the controller**.** <br>10b<br>This Migration Send command is the last command of a sequence of two or more Migration<br>Send commands with this management operation used to transfer the controller state from<br>the host to the controller.<br>11b<br>This Migration Send command is the only command and contains the entire controller state<br>for this management operation used to transfer the controller state from the host to the<br>controller.|


|Value|Definition|
|---|---|
|00b|This command is not the first or last of a sequence of two or more Migration Send commands<br>with this management operation used to transfer the controller state from the host to the<br>controller.|
|01b|This command is the first of a sequence of two or more Migration Send commands with this<br>management operation used to transfer the controller state from the host to the controller**.**|
|10b|This Migration Send command is the last command of a sequence of two or more Migration<br>Send commands with this management operation used to transfer the controller state from<br>the host to the controller.|
|11b|This Migration Send command is the only command and contains the entire controller state<br>for this management operation used to transfer the controller state from the host to the<br>controller.|


**Figure 355: Set Controller State – Command Dword 11**









|Bits|Description|
|---|---|
|31:24|**Controller State UUID Index (CSUUIDI):** A non-zero value in this field specifies the index to a specific entry<br>in the Vendor Specific Controller State UUID Supported list of the Supported Controller State Formats data<br>structure (refer to section 5.1.13.2.21). The contents of that entry specify the format of the Vendor Specific<br>field in the specified Controller State data structure.<br>If this field is cleared to 0h, then no Vendor Specific field is contained in the Controller State data structure.|
|23:16|**Controller State Version Index (CSVI):** A non-zero value in this field specifies the index to a specific entry<br>in the NVMe Controller State Version list of the Supported Controller State Formats data structure (refer to<br>section 5.1.13.2.21). The contents of that entry specify the format of the Controller State field in the specified<br>Controller State data structure.<br>If this field is cleared to 0h, then no NVMe Controller State field is specified in the Controller State data<br>structure.|
|15:00|**Controller Identifier (CNTLID):** This field specifies the identifier of the controller whose state is being set.|


**Figure 356: Set Controller State – Command Dword 12**





|Bits|Description|
|---|---|
|31:00|**Controller State Offset Lower (CSOL):**This field specifies the least-significant 32-bits of starting offset<br>within the Controller State data structure that the host is setting.<br>The offset is required to be dword aligned and if bits 1:0 are not cleared to 00b, then the controller shall<br>abort the command with a status code of Invalid Field in Command.|


**Figure 357: Set Controller State – Command Dword 13**



|Bits|Description|
|---|---|
|31:00|**Controller State Offset Upper (CSOU):**This field specifies the most-significant 32-bits of starting offset<br>within the Controller State data that the host is setting. Refer to the CSOL field definition in Figure 356.|


**Figure 358: Set Controller State – Command Dword 15**





|Bits|Description|
|---|---|
|31:00|**Number of Dwords (NUMD):** This field specifies the number of dwords being transferred.<br>This field is only allowed to be cleared to the value of 0h if the Sequence Indicator field is set to 10b.|


354


NVM Express [®] Base Specification, Revision 2.2


If the host specifies an offset (i.e., the CSLO field and the CSUO field) that is greater than the size of the
Controller State data, then the controller shall abort the command with a status code of Invalid Field in
Command.


**Figure 359: Controller State Data Structure**








|Bits|Description|
|---|---|
|07:01|Reserved|
|00|**Controller Suspended (CP):**If this bit is set to ‘1’, then the controller<br>associated with this data structure was suspended for the entire duration of<br>the processing of the Migration Receive command that reported in contents<br>this data structure. If this bit is cleared to ‘0’, then the controller associated<br>with this data structure was not suspended for the entire duration of the<br>processing of the Migration Receive command that reported the contents<br>in this data structure.|








|Bytes|Description|
|---|---|
|**Header**|**Header**|
|01:00|**Version (VER):**This field indicates the version of this data structure. This field shall be<br>cleared to 0h.|
|02|**Controller State Attributes (CSATTR):**This field specifies attributes associated with<br>the controller state.<br>**Bits**<br>**Description**<br>07:01<br>Reserved<br>00<br>**Controller Suspended (CP):**If this bit is set to ‘1’, then the controller<br>associated with this data structure was suspended for the entire duration of<br>the processing of the Migration Receive command that reported in contents<br>this data structure. If this bit is cleared to ‘0’, then the controller associated<br>with this data structure was not suspended for the entire duration of the<br>processing of the Migration Receive command that reported the contents<br>in this data structure.|
|15:03|Reserved|
|31:16|**NVMe Controller State Size (NVMECSS):** This field indicates the number of dwords<br>in the NVMe Controller State field.|
|47:32|**Vendor Specific Size (VSS):** This field indicates the number of dwords in the Vendor<br>Specific Data field.|
|**Controller State Data**|**Controller State Data**|
|(NVMECSS*4)+47:48|**NVMe Controller State (NVMECS):**If the NVMECSS field is non-zero, then this field<br>contains the controller state data as defined in Figure 360. If the NVMECSS field is<br>cleared to 0h, then this field does not exist in the data structure.|
|((VSS+NVMECSS)*4)+47:<br>(NVMECSS*4)+48|**Vendor Specific Data (VSD):**If the VSS field is non-zero, then this field contains<br>vendor specific data. If the VSS field is cleared to 0h, then this field does not exist in<br>the data structure.|



If the CSVI field (refer to Figure 355) specifies a non-zero index that is not defined by the Supported
Controller State Formats data structure (refer to Figure 330), then the controller shall abort the command
with a status code of Invalid Field in Command.


If the CSVI field (refer to Figure 355) is cleared to 0h and the NVMe Controller State Size field is non-zero,
then the controller shall abort the command with a status code of Invalid Field in Command.


If the CSUUIDI field (refer to Figure 355) specifies a non-zero index that is not defined by the Supported
Controller State Formats data structure, then the controller shall abort the command with a status code of
Invalid Field in Command.


If the NVMe Controller State field exists (i.e., the NVMECSS field is non-zero) and any I/O Submission
Queue or I/O Completion Queue exists in the controller specified by the Controller Identifier (CNTLID) field,
then the controller shall abort the command with a status code of Invalid Field in Command.


Figure 360 defines the NVMe Controller State data structure that identifies the state of the all the I/O
Submission Queues and I/O Completion Queues for a controller. Any controller state defined by this
specification that is not included in the NVMe Controller State data structure is either included in the Vendor
Specific Data field in the Controller State data structure (refer to Figure 359) or is obtained in a vendor
specific manner.


355


NVM Express [®] Base Specification, Revision 2.2


**Figure 360: NVMe Controller State Data Structure**


















|Bytes|Description|
|---|---|
|**Header**|**Header**|
|01:00|**Version (VER):** This field indicates the version of this data structure. This field shall be<br>cleared to 0h.|
|03:02|**Number of I/O Submission Queues (NIOSQ):** This field indicates the number I/O<br>Submission Queues contained in this data structure.|
|05:04|**Number of I/O Completion Queues (NIOCQ):** This field indicates the number I/O<br>Completion Queues contained in this data structure.|
|07:06|Reserved|
|**I/O Submission Queue List**|**I/O Submission Queue List**|
|31:08|**I/O Submission Queue State 0:**This field contains the state of the first I/O Submission<br>Queue reported, if any. The contents of this field are defined in the I/O Submission Queue<br>State data structure (refer to Figure 361).|
|55:32|**I/O Submission Queue State 1:**This field contains the state of the second I/O<br>Submission Queue reported, if any. The contents of this field are defined in the I/O<br>Submission Queue State data structure (refer to Figure 361).|
|…|…|
|((NIOSQ) * 24) + 7:<br>((NIOSQ-1) * 24) + 8|**I/O Submission Queue State NIOSQ-1:**This field contains the state of the last I/O<br>Submission Queue reported, if any. The contents of this field are defined in the I/O<br>Submission Queue State data structure (refer to Figure 361).|
|**I/O Completion Queue List**|**I/O Completion Queue List**|
|((NIOSQ+1) * 24) + 7:<br>((NIOSQ) * 24) + 8|**I/O Completion Queue State 0:**This field contains the state of the first I/O Completion <br>Queue reported, if any. The contents of this field are defined in the I/O Completion Queue<br>State data structure (refer to Figure 362).|
|((NIOSQ+2) * 24) + 7:<br>((NIOSQ+1) * 24) + 8|**I/O Completion Queue State 1:**This field contains the state of the second I/O<br>Completion Queue reported, if any. The contents of this field are defined in the I/O<br>Completion Queue State data structure (refer to Figure 362).|
|…|…|
|((NIOCQ) * 24) +<br>((NIOSQ) * 24) + 15:<br>((NIOCQ-1) * 24) +<br>((NIOSQ) * 24) + 8|**I/O Completion Queue State NIOSQ-1:**This field contains the state of the last I/O<br>Completion Queue reported, if any. The contents of this field are defined in the I/O<br>Completion Queue State data structure (refer to Figure 362).|



The I/O Submission Queue list shall be listed in ascending order by I/O Submission Queue Identifier.


The I/O Completion Queue list shall be listed in ascending order by I/O Completion Queue Identifier.


**Figure 361: I/O Submission Queue State Data Structure**

|Bytes|Description|
|---|---|
|07:00|**I/O Submission PRP Entry 1 (IOSQPRP1):**This field contains the contents of the PRP1 field (refer to<br>Figure 478) from the Create I/O Submission Queue command that created this I/O Submission Queue.|
|09:08|**I/O Submission Queue Size (IOSQQSIZE):**This field contains the contents of the QSIZE field (refer to<br>Figure 479) from the Create I/O Submission Queue command that created this I/O Submission Queue.|
|11:10|**I/O Submission Queue Identifier (IOSQQID):**This field contains the contents of the QID field (refer to<br>Figure 479) from the Create I/O Submission Queue command that created this I/O Submission Queue.|
|13:12|**I/O Completion Queue Identifier (IOSQCQID):**This field contains the contents of the CQID field (refer<br>to Figure 480) from the Create I/O Submission Queue command that created this I/O Submission Queue.|



356


NVM Express [®] Base Specification, Revision 2.2


**Figure 361: I/O Submission Queue State Data Structure**








|Bits|Description|
|---|---|
|15:03|Reserved|
|02:01|**I/O Submission Queue Priority (IOSQQPRIO):**This field contains the contents of the QPRIO<br>field (refer to Figure 480) from the Create I/O Submission Queue command that created this<br>I/O Submission Queue.|
|00|**I/O Submission Queue Physically Contiguous (IOSQPC):**This bit contains the contents of<br>the PC bit (refer to Figure 480) from the Create I/O Submission Queue command that created<br>this I/O Submission Queue.|



|Bytes|Description|
|---|---|
|15:14|**I/O Submission Queue Attributes (IOSQA):**This field contains various attributes associated with the I/O<br>Submission Queue.<br>**Bits**<br>**Description**<br>15:03<br>Reserved<br>02:01<br>**I/O Submission Queue Priority (IOSQQPRIO):**This field contains the contents of the QPRIO<br>field (refer to Figure 480) from the Create I/O Submission Queue command that created this<br>I/O Submission Queue.<br>00<br>**I/O Submission Queue Physically Contiguous (IOSQPC):**This bit contains the contents of<br>the PC bit (refer to Figure 480) from the Create I/O Submission Queue command that created<br>this I/O Submission Queue.|
|17:16|**I/O Submission Queue Head Pointer (IOSQHP):**This field indicates the value of the I/O Submission<br>Queue head pointer.|
|19:18|**I/O Submission Queue Tail Pointer (IOSQTP):**This field indicates the value of the I/O Submission<br>Queue tail pointer.|
|23:20|Reserved|


**Figure 362: I/O Completion Queue State Data Structure**

















|Bytes|Description|
|---|---|
|07:00|**I/O Completion Queue Size PRP Entry 1 (IOCQPRP1):**This field contains the contents of the PRP1<br>field (refer to Figure 474) from the Create I/O Completion Queue command that created this I/O<br>Completion Queue.|
|09:08|**I/O Completion Queue Size (IOCQQSIZE):**This field contains the contents of the QSIZE field (refer to<br>Figure 475) from the Create I/O Completion Queue command that created this I/O Completion Queue.|
|11:10|**I/O Completion Queue Identifier (IOCQQID):**This field contains the contents of the PRP1 field (refer to<br>Figure 475) from the Create I/O Completion Queue command that created this I/O Completion Queue.|
|13:12|**I/O Completion Queue Head Pointer (IOCQHP):**This field indicates the value of the I/O Completion<br>Queue head pointer.|
|15:14|**I/O Completion Queue Tail Pointer (IOCQTP):**This field indicates the value of the I/O Completion<br>Queue tail pointer.|
|19:16|**I/O Completion Queue Attributes (IOCQA):**This field contains various attributes associated with the<br>I/O Completion Queue.<br>**Bits**<br>**Description**<br>31:16<br>**I/O Completion Queue Interrupt Vector (IOCQIV):**This field contains the contents of the<br>IV field (refer to Figure 476) from the Create I/O Completion Queue command that created<br>this I/O Completion Queue.<br>15:03<br>Reserved<br>02<br>**Slot 0 Phase Tag (S0PT):**This bit states the value of the Phase Tag bit for slot 0 of this I/O<br>Completion Queue.<br>01<br>**I/O Completion Queue Interrupts Enabled (IOCQIEN):**This bit contains the contents of<br>the IEN bit (refer to Figure 476) from the Create I/O Completion Queue command that<br>created this I/O Completion Queue.<br>00<br>**I/O Completion Queue Physically Contiguous (IOCQPC):**This bit contains the contents<br>of the PC bit (refer to Figure 476) from the Create I/O Completion Queue command that<br>created this I/O Completion Queue.|
|23:20|Reserved|


|Bits|Description|
|---|---|
|31:16|**I/O Completion Queue Interrupt Vector (IOCQIV):**This field contains the contents of the<br>IV field (refer to Figure 476) from the Create I/O Completion Queue command that created<br>this I/O Completion Queue.|
|15:03|Reserved|
|02|**Slot 0 Phase Tag (S0PT):**This bit states the value of the Phase Tag bit for slot 0 of this I/O<br>Completion Queue.|
|01|**I/O Completion Queue Interrupts Enabled (IOCQIEN):**This bit contains the contents of<br>the IEN bit (refer to Figure 476) from the Create I/O Completion Queue command that<br>created this I/O Completion Queue.|
|00|**I/O Completion Queue Physically Contiguous (IOCQPC):**This bit contains the contents<br>of the PC bit (refer to Figure 476) from the Create I/O Completion Queue command that<br>created this I/O Completion Queue.|


If the CSVI field (refer to Figure 355) is cleared to 0h and the NVMe Controller State Size field (refer to
Figure 359) is not cleared to 0h, then the controller shall abort the command with a status code of Invalid
Field in Command.


If the CSUUIDI field (refer to Figure 355) is cleared to 0h and the Vendor Specific Size field (refer to Figure
359) is not cleared to 0h, then the controller shall abort the command with a status code of Invalid Field in
Command.


357


NVM Express [®] Base Specification, Revision 2.2


If the CSVI field(refer to Figure 355) is cleared to 0h and the CSUUIDI field (refer to Figure 355) is cleared
to 0h, then the controller shall abort the command with a status code of Invalid Field in Command.


If the Migration Send command for this management operation specifies the SEQIND field set to 10b and
that command completes successfully, then the controller state shall be verified and committed to the
specified controller which includes:


   - Creating any I/O Submission Queues and I/O Completion Queues specified by the NVMe
Controller State field; and

   - setting the queue state for each I/O Submission Queues and I/O Completion Queues specified by
the NVMe Controller State field.


If any Migration Send command for this management operation is not successful, then the host should
attempt to re-transfer the entire controller state data so that any existing controller state is overwritten with
the desired controller state.


**Command Completion**


Upon completion of the Migration Send command, the controller posts a completion queue entry to the
Admin Completion Queue indicating the status for the command. Section 5.1.17.1 describes completion
details for each management operation.


Migration Send command specific status values (i.e., SCT field set to 1h) are shown in Figure 363.


**Figure 363: Migration Send – Command Specific Status Values**

|Value|Definition|
|---|---|
|1Fh|**Invalid Controller Identifier:**The specified controller is not in a condition to set the controller state.|
|37h|**Invalid Controller Data Queue:** This error indicates that the specified Controller Data Queue<br>Identifier is invalid for the controller processing the command.|
|38h|**Not Enough Resources:**This error indicates that there is not enough resources in the controller to<br>process the command.|
|3Ah|**Controller Not Suspended:**The operation requested is not allowed if the specified controller is not<br>suspended (refer to section 5.1.17.1.1).|

