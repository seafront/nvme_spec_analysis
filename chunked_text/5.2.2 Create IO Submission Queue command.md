

**Create I/O Submission Queue command**


The Create I/O Submission Queue command is used to create I/O Submission Queues. The Admin
Submission Queue is created by specifying its base address in the ASQ property. If a PRP List is provided
to describe the SQ to be created, then the PRP List shall be maintained by host software at the same
location in host physical memory and the values in the PRP List shall not be modified until the corresponding
Delete I/O Submission Queue command for that SQ is completed or the controller is reset. If the PRP List
values are modified, the behavior is undefined.


The Create I/O Submission Queue command uses the PRP Entry 1, Command Dword 10, Command
Dword 11, and Command Dword 12 fields. All other command specific fields are reserved.


**Figure 478: Create I/O Submission Queue – PRP Entry 1**





|Bits|Description|
|---|---|
|63:00|**PRP Entry 1 (PRP1):**If CDW11.PC is set to ‘1’, then this field specifies a 64-bit base memory address<br>pointer of the Submission Queue that is physically contiguous. The address pointer is memory page<br>aligned (based on the value in CC.MPS) unless otherwise specified. If CDW11.PC is cleared to ‘0’, then<br>this field specifies a PRP List pointer that describes the list of pages that constitute the Submission<br>Queue. The list of pages is memory page aligned (based on the value in CC.MPS) unless otherwise<br>specified. In both cases, the PRP Entry shall have an offset of 0h. In a non-contiguous Submission<br>Queue, each PRP Entry in the PRP List shall have an offset of 0h. If there is a PRP Entry with a non-<br>zero offset, then the controller should return an error of PRP Offset Invalid.|


**Figure 479: Create I/O Submission Queue – Command Dword 10**







|Bits|Description|
|---|---|
|31:16|**Queue Size (QSIZE):**This field specifies the size of the Submission Queue to be created. If the size is<br>0h or larger than the controller supports, the controller should return an error of Invalid Queue Size. Refer<br>to section 3.3.3.1. This is a 0’s based value.|
|15:00|**Queue Identifier (QID):**This field specifies the identifier to assign to the Submission Queue to be<br>created. This identifier corresponds to the Submission Queue Tail Doorbell used for this command (i.e.,<br>the value_y_ in SQyTDBL section of the NVMe over PCIe Transport Specification). This value shall not<br>exceed the value reported in the Number of Queues feature (refer to section 5.1.25.2.1) for I/O<br>Submission Queues. If the value specified is 0h, exceeds the Number of Queues reported, or<br>corresponds to an identifier already in use, the controller should return an error of Invalid Queue Identifier.|


417


NVM Express [®] Base Specification, Revision 2.2


**Figure 480: Create I/O Submission Queue – Command Dword 11**





|Bits|Description|
|---|---|
|31:16|**Completion Queue Identifier (CQID):**This field specifies the identifier of the I/O Completion Queue<br>to utilize for any command completions entries associated with this Submission Queue.<br>If the value specified:<br>a)<br>is 0h (i.e., the Admin Completion Queue), then the controller shall abort the command with<br>a status code of Invalid Queue Identifier;<br>b)<br>is outside the range supported by the controller, then the controller shall abort the command<br>with a status code of Invalid Queue Identifier; or<br>c)<br>is within the range supported by the controller and does not specify an I/O Completion Queue<br>that has been created, then the controller shall abort the command with a status code of<br>Completion Queue Invalid.|
|15:03|Reserved|
|02:01|**Queue Priority (QPRIO):**This field specifies the priority class to use for commands within this<br>Submission Queue. This field is only used when the weighted round robin with urgent priority class is<br>the arbitration mechanism selected. This field shall be ignored by the controller if weighted round robin<br>with urgent priority class is not used. Refer to section 3.4.4.<br>**Value**<br>**Definition**<br>00b<br>Urgent<br>01b<br>High<br>10b<br>Medium<br>11b<br>Low|
|00|**Physically Contiguous (PC):**If this bit is set to ‘1’, then the Submission Queue is physically<br>contiguous and PRP Entry 1 (PRP1) is the address of a contiguous physical buffer. If this bit is cleared<br>to ‘0’, then the Submission Queue is not physically contiguous and PRP Entry 1 (PRP1) is a PRP List<br>pointer. If this bit is cleared to ‘0’ and CAP.CQR is set to ‘1’, then the controller should return an error<br>of Invalid Field in Command.<br>If the:<br>• <br>queue is located in the Controller Memory Buffer;<br>• <br>PC is cleared to ‘0’; and<br>• <br>CMBLOC.CQPDS is cleared to ‘0’,<br>then the controller shall abort the command with Invalid Use of Controller Memory Buffer status.|


|Value|Definition|
|---|---|
|00b|Urgent|
|01b|High|
|10b|Medium|
|11b|Low|


**Figure 481: Create I/O Submission Queue – Command Dword 12**







|Bits|Description|
|---|---|
|31:16|Reserved|
|15:00|**NVM Set Identifier (NVMSETID):** This field indicates the identifier of the NVM Set to be associated with<br>this Submission Queue.<br>If this field is cleared to 0h or the SQ Associations capability is not supported (refer to section 8.1.25),<br>then this Submission Queue is not associated with any specific NVM Set.<br>If this field is set to a non-zero value that is not specified in the NVM Set List (refer to Figure 318) and<br>the SQ Associations capability is supported (refer to section 8.1.25), then the controller shall abort the<br>command with a status code of Invalid Field in Command.<br>The host should not submit commands for namespaces associated with other NVM Sets in this<br>Submission Queue (refer to section 8.1.25).|


**Command Completion**



Upon completion of the Create I/O Submission Queue command, the controller posts a completion queue
entry to the Admin Completion Queue.


Create I/O Submission Queue command specific status values are defined in Figure 482.


418


NVM Express [®] Base Specification, Revision 2.2


**Figure 482: Create I/O Submission Queue – Command Specific Status Values**





|Value|Definition|
|---|---|
|0h|**Completion Queue Invalid:** The Completion Queue identifier specified in the command has not been<br>created.|
|1h|**Invalid Queue Identifier:**The creation of the I/O Submission Queue failed due an invalid queue identifier<br>specified as part of the command. An invalid queue identifier is one that identifies the Admin Queue (i.e., 0h),<br>is outside the range supported by the controller, or is a Submission Queue Identifier that is already in use.|
|2h|**Invalid Queue Size:**The host attempted to create an I/O Submission Queue:<br>• <br>with an invalid number of entries (e.g., a value of 0h or a value which exceeds the maximum<br>supported by the controller, specified in CAP.MQES); or<br>• <br>before initializing the CC.IOSQES field.|