**Migration Receive command**

The Migration Receive command is used to obtain information from the controller processing the command
that the host may use to manage a migratable controller (refer to section 8.1.12).


The Migration Receive command uses the Data Pointer field, Command Dword 10 field, Command Dword
12 field, Command Dword 13 field, Command Dword 14 field, and Command Dword 15 field. The use of
the Command Dword 11 field is specific to the management operation specified by the Select field . All other
command specific fields are reserved.


The Select field defined in Figure 341 specifies the management operation to be performed. Refer to section
5.1.16.1for a description of each management operation.


**Figure 341: Migration Receive – Command Dword 10**





|Bits|Description|
|---|---|
|31:16|**Management Operation Specific (MOS):**The definition of this field is specific to a management operation<br>(refer to the Select field). If a management operation does not define the use of this field, then this field is<br>reserved.|
|15:08|Reserved|
|07:00|**Select (SEL):**This field specifies the type of management operation to perform.<br>**Value**<br>**M/O1 **<br>**Management Operation**<br>**Reference Section**<br>0h<br>M <br>Get Controller State<br>5.1.16.1.1<br>1h to FFh<br> <br>Reserved<br>Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|


|Value|1<br>M/O|Management Operation|Reference Section|
|---|---|---|---|
|0h|M|Get Controller State|5.1.16.1.1|
|1h to FFh||Reserved|Reserved|
|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|Notes:<br>1.<br>O/M definition: O = Optional, M = Mandatory|


**Figure 342: Migration Receive – Command Dword 12**







|Bits|Description|
|---|---|
|31:00|**Offset Lower (OL):**This field specifies the least-significant 32-bits of the offset, in bytes, within the data<br>available to be returned and specifies the starting point for that data for what is actually returned to the host.<br>The offset is required to be dword aligned and if bits 1:0 are not cleared to 00b, then the controller shall<br>abort the command with a status code of Invalid Field in Command.<br>If the host specifies an offset (i.e., OL field and OU field) that is greater than the size of the returned data<br>requested (e.g., the returned data contains 100 bytes is requested starting at offset 200), then the controller<br>shall abort the command with a status of Invalid Field in Command.|


**Figure 343: Migration Receive – Command Dword 13**








|Bits|Description|
|---|---|
|31:00|**Offset Upper (OU):**This field specifies the most-significant 32-bits of the offset, in bytes, within the data<br>available to be returned and specifies the starting point for that data for what is actually returned to the host.<br>Refer to the Offset Lower field definition in Figure 341.|



If the controller supports selection of a UUID by the Migration Receive command (refer to Figure 211 and
section 8.1.28), then Command Dword 14 is used to specify a UUID Index value (refer to Figure 344).


347


NVM Express [®] Base Specification, Revision 2.2


**Figure 344: Migration Receive – Command Dword 14**

|Bits|Description|
|---|---|
|31:07|Reserved|
|06:00|**UUID Index (UIDX):** Refer to Figure 659.|



**Figure 345: Migration Receive – Command Dword 15**





|Bits|Description|
|---|---|
|31:00|**Number of Dwords (NUMDL):** This field specifies the number of dwords to return. If the host specifies a<br>value that is greater than the number of dwords returned by the specified management operation of the<br>command, then the controller returns the number of dwords defined by the specified management operation<br>of the command with undefined results for the remaining dwords. This is a 0’s based value.|


**Migration Receive Management Operations**



**5.1.16.1.1 Get Controller State (Management Operation 0h)**


The Get Controller State management operation of the Migration Receive command allows the host to
retrieve from the controller processing the command state data for the controller specified in the Controller
Identifier field in the Management Operation Specific field (refer to Figure 346). The data returned in the
data buffer is the Controller State data structure as defined by Figure 359.


If the controller specified in the Controller Identifier field in the Management Operation Specific field (i.e.,
the specified controller):


  - is suspended (refer to section 5.1.17.1.1); and

  - remains suspended during the processing of the Migration Receive command,


then:


  - the specified controller has stopped processing commands; and

  - if:

`o` a Controller Level Reset has not occurred on the specified controller during the processing
of the Migration Receive command; or
`o` the host does not modify controller properties on the specified controller during the
processing of the Migration Receive command,


then the returned Controller State data structure is consistent between each field reported in that
data structure.


If the specified controller:


   - is not suspended during the processing of the Migration Receive command; or

   - has a Controller Level Reset during the processing of the Migration Receive command,


then the specified controller state may be changing during the processing of the Migration Receive
command and:


  - each field in the reported Controller State data structure contains the value that reflects the state
of the specified controller at the time the value was obtained by the controller processing the
Migration Receive command; and

  - state of the specified controller may be at a different state when a value is obtained between
different fields (i.e., the returned Controller State data structure may or may not be internally
consistent between each field).


The Get Controller State management operation uses the Management Operation Specific field as defined
in Figure 346 and the Command Dword 11 field as defined in Figure 347.


348


NVM Express [®] Base Specification, Revision 2.2


**Figure 346: Get Controller State Management Operation – Management Operation Specific**






|Bits|Description|
|---|---|
|15:08|Reserved|
|7:0|**Controller State Version Index (CSVI):** A non-zero value in this field specifies the index to a specific entry<br>in the Controller State Version Supported list of the Supported Controller State Formats data structure<br>(refer to section 5.1.13.2.21). The contents of that entry specify the format of the Controller State field in<br>the returned data.<br>If this field is cleared to 0h, then no Controller State field is returned in the returned data.|



The Get Controller State management operation of the Migration Receive command uses Command Dword
11 as defined in Figure 347.


**Figure 347: Get Controller State Management Operation – Command Dword 11**







|Bits|Description|
|---|---|
|31:24|**Controller State UUID Index Parameter (CSUIDXP)**: This field is vendor specific.<br>If the Controller State UUID Index field is cleared to 0h, then the controller shall ignore this field.|
|23:16|**Controller State UUID Index (CSUUIDI):** A non-zero value in this field specifies the index to a specific entry<br>in the Vendor Specific Controller State UUID Supported list of the Supported Controller State Formats data<br>structure (refer to section 5.1.13.2.21). The contents of that entry specify the format of the Vendor Specific<br>field in the returned data.<br>If this field is cleared to 0h, then no Vendor Specific field is returned in the returned data.|
|15:00|**Controller Identifier (CNTLID):** This field specifies the identifier of the controller on which the management<br>operation is performed.|


If the CSVI field (refer to Figure 347) specifies a non-zero index that is not defined by the Supported
Controller State Formats data structure (refer to Figure 330), then the controller shall abort the command
with a status code of Invalid Field in Command.


If the CSVI field is cleared to 0h, then the Controller State Size field in the returned data shall be cleared to
0h.


If the CSUUIDI field specifies a non-zero index that is not defined by the Supported Controller State Formats
data structure, then the controller shall abort the command with a status code of Invalid Field in Command.


If the CSUUIDI field is cleared to 0h, then the Vendor Specific Size field in the returned data shall be cleared
to 0h.


If a status code of Successful Completion is returned, then the completion queue entry Dword 0 contains
additional information about the command as defined in Figure 348.


**Figure 348: Get Controller State Management Operation – Completion Queue Entry Dword 0**






|Bits|Description|
|---|---|
|31:01|Reserved|
|00|**Controller Suspended (CSUP):**If this bit is set to ‘1’, then the controller associated with the returned<br>data structure wassuspended for the entire duration of the processing of this command. If this bit is<br>cleared to ‘0’, then the controller associated with this data structure was notsuspended for the entire<br>duration of the processing of this command.|



**5.1.16.1.2 Command Completion**


The Upon completion of the Migration Receive command, the controller posts a completion queue entry to
the Admin Completion Queue indicating the status for the command. Section 5.1.16.1 describes completion
details for each management operation.


Migration Receive command specific status values (i.e., SCT field set to 1h) are shown in Figure 349.


349


NVM Express [®] Base Specification, Revision 2.2


**Figure 349: Migration Receive – Command Specific Status Values**

|Value|Definition|
|---|---|
|1Fh|**Invalid Controller Identifier:**The specified controller is not in a condition to set the controller state.|

