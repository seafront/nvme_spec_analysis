# Firmware Image Download Command 테스트 시나리오

## 1. 개요

| 항목 | 값 |
|------|-----|
| **Command Name** | Firmware Image Download |
| **총 요구사항 수** | 21개 |
| **도출된 시나리오 수** | 42개 |
| **커버리지 목표** | 100% (모든 요구사항에 대해 최소 1개 시나리오) |
| **작성일** | 2026-01-13 |

### 1.1 시나리오 유형 분포

| 유형 | 개수 | 비율 |
|------|------|------|
| Positive | 18개 | 43% |
| Negative | 16개 | 38% |
| Boundary | 8개 | 19% |

---

## 2. 테스트 시나리오 목록

### 2.1 기본 명령 구조 시나리오

#### TS-FID-001: Opcode 값 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-001 |
| **시나리오 유형** | Positive |
| **설명** | Firmware Image Download 명령이 Admin Command opcode 0x11을 사용하는지 검증한다 |
| **사전 조건** | 컨트롤러가 초기화되어 있음 |
| **테스트 입력** | FirmwareImageDownload 명령 생성 |
| **기대 결과** | 생성된 명령의 opcode 필드가 0x11임 |
| **우선순위** | P1 |

#### TS-FID-002: Data Pointer 필드 설정 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-002 |
| **시나리오 유형** | Positive |
| **설명** | DPTR 필드가 데이터 전송 위치를 올바르게 지정하는지 검증한다 |
| **사전 조건** | 유효한 데이터 버퍼가 할당되어 있음 |
| **테스트 입력** | 데이터 버퍼 주소를 DPTR에 설정 |
| **기대 결과** | DPTR 필드에 지정한 버퍼 주소가 정확히 설정됨 |
| **우선순위** | P1 |

#### TS-FID-003: CDW10 NUMD 필드 설정 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-003 |
| **시나리오 유형** | Positive |
| **설명** | CDW10의 NUMD 필드(bits 31:00)가 0's based 값으로 dword 수를 지정하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | NUMD = 0 (1 dword 전송), NUMD = 255 (256 dwords 전송) |
| **기대 결과** | NUMD 필드가 입력값으로 정확히 설정되고, 실제 전송 크기는 (NUMD + 1) dwords |
| **우선순위** | P1 |

#### TS-FID-004: CDW11 OFST 필드 설정 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-004 |
| **시나리오 유형** | Positive |
| **설명** | CDW11의 OFST 필드(bits 31:00)가 dword 오프셋을 올바르게 지정하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | OFST = 0, OFST = 1024, OFST = 0xFFFFFFFF |
| **기대 결과** | OFST 필드가 입력값으로 정확히 설정됨 |
| **우선순위** | P1 |

#### TS-FID-005: 첫 번째 이미지 조각의 OFST가 0인지 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-005 |
| **시나리오 유형** | Positive |
| **설명** | 펌웨어 이미지 시작 조각의 OFST 값이 0h인지 검증한다 |
| **사전 조건** | 새로운 펌웨어 이미지 다운로드 시작 |
| **테스트 입력** | 첫 번째 조각: OFST = 0 |
| **기대 결과** | 명령이 성공적으로 완료됨 |
| **우선순위** | P1 |

### 2.2 FWUG 관련 시나리오

#### TS-FID-006: NUMD가 FWUG 요구사항 충족 시 성공
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-006 |
| **시나리오 유형** | Positive |
| **설명** | NUMD 필드 값이 FWUG 필드 요구사항을 충족하면 명령이 성공하는지 검증한다 |
| **사전 조건** | FWUG = 4KB (granularity) |
| **테스트 입력** | NUMD = 1023 (4KB - 1 = 1024 dwords) |
| **기대 결과** | 명령이 Success(0x00) 상태로 완료됨 |
| **우선순위** | P1 |

#### TS-FID-007: NUMD가 FWUG 요구사항 미충족 시 오류
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-006 |
| **시나리오 유형** | Negative |
| **설명** | NUMD 필드 값이 FWUG 필드 요구사항을 충족하지 않으면 Invalid Field in Command 오류가 발생하는지 검증한다 |
| **사전 조건** | FWUG = 4KB (granularity) |
| **테스트 입력** | NUMD = 511 (2KB = 512 dwords, granularity 미충족) |
| **기대 결과** | Invalid Field in Command(0x02) 상태 코드 반환 |
| **우선순위** | P1 |

#### TS-FID-008: OFST가 FWUG 요구사항 충족 시 성공
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-007 |
| **시나리오 유형** | Positive |
| **설명** | OFST 필드 값이 FWUG 필드 alignment 요구사항을 충족하면 명령이 성공하는지 검증한다 |
| **사전 조건** | FWUG = 4KB (granularity) |
| **테스트 입력** | OFST = 1024 (4KB aligned) |
| **기대 결과** | 명령이 Success(0x00) 상태로 완료됨 |
| **우선순위** | P1 |

#### TS-FID-009: OFST가 FWUG alignment 미충족 시 오류
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-007 |
| **시나리오 유형** | Negative |
| **설명** | OFST 필드 값이 FWUG 필드 alignment 요구사항을 충족하지 않으면 Invalid Field in Command 오류가 발생하는지 검증한다 |
| **사전 조건** | FWUG = 4KB (granularity) |
| **테스트 입력** | OFST = 512 (2KB, misaligned) |
| **기대 결과** | Invalid Field in Command(0x02) 상태 코드 반환 |
| **우선순위** | P1 |

### 2.3 중복 범위 시나리오

#### TS-FID-010: 겹치지 않는 범위로 다운로드 성공
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-008, REQ-FID-017 |
| **시나리오 유형** | Positive |
| **설명** | 이미지 조각들의 dword 범위가 중복되지 않으면 명령이 성공하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | 조각1: OFST=0, NUMD=1023; 조각2: OFST=1024, NUMD=1023 |
| **기대 결과** | 두 명령 모두 Success(0x00) 상태로 완료됨 |
| **우선순위** | P1 |

#### TS-FID-011: 중복 범위 감지 시 Overlapping Range 오류
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-008 |
| **시나리오 유형** | Negative |
| **설명** | 이미지 조각들의 dword 범위가 중복되면 Overlapping Range 오류가 반환되는지 검증한다 |
| **사전 조건** | 첫 번째 조각이 이미 다운로드됨 (OFST=0, NUMD=2047) |
| **테스트 입력** | 두 번째 조각: OFST=1024, NUMD=1023 (범위 중복) |
| **기대 결과** | Overlapping Range(0x14) 상태 코드 반환 |
| **우선순위** | P1 |

#### TS-FID-012: 부분 중복 범위 감지
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-008 |
| **시나리오 유형** | Negative |
| **설명** | 이미지 조각들이 부분적으로 중복되는 경우 오류가 발생하는지 검증한다 |
| **사전 조건** | 첫 번째 조각: OFST=0, NUMD=1023 |
| **테스트 입력** | 두 번째 조각: OFST=1000, NUMD=1023 (24 dwords 중복) |
| **기대 결과** | Overlapping Range(0x14) 상태 코드 반환 |
| **우선순위** | P2 |

### 2.4 동시 처리 시나리오

#### TS-FID-013: 다른 명령 처리 중 제출 가능
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-009 |
| **시나리오 유형** | Positive |
| **설명** | Admin/I/O Submission Queue에 다른 명령이 처리 중일 때도 Firmware Image Download 명령이 제출될 수 있는지 검증한다 |
| **사전 조건** | I/O 명령이 진행 중 |
| **테스트 입력** | Firmware Image Download 명령 제출 |
| **기대 결과** | 명령이 성공적으로 큐에 등록되고 처리됨 |
| **우선순위** | P1 |

### 2.5 다중 조각 다운로드 시나리오

#### TS-FID-014: 여러 조각으로 이미지 다운로드
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-010 |
| **시나리오 유형** | Positive |
| **설명** | 펌웨어 이미지를 여러 조각으로 나누어 개별 명령으로 다운로드할 수 있는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | 4개의 조각으로 나눈 펌웨어 이미지 (각 4KB) |
| **기대 결과** | 모든 조각이 성공적으로 다운로드됨 |
| **우선순위** | P1 |

#### TS-FID-015: 비순차적 조각 다운로드
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-011 |
| **시나리오 유형** | Positive |
| **설명** | 펌웨어 조각을 순서에 관계없이 제출할 수 있는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | 조각 순서: 3, 1, 4, 2 |
| **기대 결과** | 모든 조각이 성공적으로 다운로드됨 |
| **우선순위** | P2 |

#### TS-FID-016: Boot Partition 순차 다운로드 성공
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-012 |
| **시나리오 유형** | Positive |
| **설명** | Boot Partition 업데이트 시 이미지 조각을 순서대로 제출하면 성공하는지 검증한다 |
| **사전 조건** | Boot Partition 업데이트 모드 |
| **테스트 입력** | 조각 순서: 1, 2, 3, 4 (순차적) |
| **기대 결과** | 모든 조각이 성공적으로 다운로드됨 |
| **우선순위** | P2 |

#### TS-FID-017: Boot Partition 비순차 다운로드 시 오류
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-012 |
| **시나리오 유형** | Negative |
| **설명** | Boot Partition 업데이트 시 이미지 조각을 비순차적으로 제출하면 오류가 발생하는지 검증한다 |
| **사전 조건** | Boot Partition 업데이트 모드 |
| **테스트 입력** | 조각 순서: 2, 1, 3, 4 (비순차적) |
| **기대 결과** | 오류 상태 코드 반환 |
| **우선순위** | P2 |

### 2.6 활성화 관련 시나리오

#### TS-FID-018: 다운로드만으로 펌웨어 비활성화 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-013 |
| **시나리오 유형** | Positive |
| **설명** | Firmware Image Download 명령 완료 후 새 펌웨어가 자동으로 활성화되지 않는지 검증한다 |
| **사전 조건** | 현재 활성 펌웨어 슬롯 확인 |
| **테스트 입력** | 새 펌웨어 이미지 다운로드 완료 |
| **기대 결과** | 활성 펌웨어 슬롯이 변경되지 않음 |
| **우선순위** | P1 |

#### TS-FID-019: Firmware Commit 없이 새 이미지 다운로드 시 동작
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-014 |
| **시나리오 유형** | Negative |
| **설명** | 이미지 다운로드 후 Firmware Commit 없이 다른 이미지를 다운로드할 때의 동작을 검증한다 |
| **사전 조건** | 첫 번째 이미지 다운로드 완료 (Commit 없음) |
| **테스트 입력** | 두 번째 이미지 다운로드 시작 |
| **기대 결과** | 컨트롤러가 적절한 동작 수행 (구현에 따라 오류 또는 기존 이미지 폐기) |
| **우선순위** | P1 |

### 2.7 이미지 폐기 시나리오

#### TS-FID-020: Firmware Commit 후 첫 다운로드 시 기존 조각 폐기
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-015 |
| **시나리오 유형** | Positive |
| **설명** | Firmware Commit 명령 완료 후 첫 번째 Firmware Image Download 명령 처리 시 기존 다운로드 조각들이 폐기되는지 검증한다 |
| **사전 조건** | 이전 펌웨어 이미지 다운로드 및 Commit 완료 |
| **테스트 입력** | 새 펌웨어 이미지 첫 번째 조각 다운로드 |
| **기대 결과** | 이전 다운로드 조각들이 폐기되고 새 조각만 유지됨 |
| **우선순위** | P1 |

#### TS-FID-021: Controller Level Reset 시 다운로드 조각 폐기
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-016 |
| **시나리오 유형** | Positive |
| **설명** | 펌웨어 다운로드 중 Controller Level Reset 발생 시 다운로드된 조각들이 폐기되는지 검증한다 |
| **사전 조건** | 펌웨어 이미지 일부 조각 다운로드 완료 |
| **테스트 입력** | Controller Level Reset 수행 |
| **기대 결과** | 리셋 후 다운로드된 조각들이 폐기됨 |
| **우선순위** | P1 |

#### TS-FID-022: Reset 후 새 다운로드 시작
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-016 |
| **시나리오 유형** | Positive |
| **설명** | Controller Level Reset 후 새 펌웨어 다운로드를 처음부터 시작할 수 있는지 검증한다 |
| **사전 조건** | 리셋으로 인해 이전 다운로드 조각 폐기됨 |
| **테스트 입력** | OFST=0부터 새 펌웨어 다운로드 시작 |
| **기대 결과** | 새 다운로드가 성공적으로 시작됨 |
| **우선순위** | P1 |

### 2.8 Completion Queue 시나리오

#### TS-FID-023: Completion Queue Entry 생성 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-019 |
| **시나리오 유형** | Positive |
| **설명** | Firmware Image Download 명령 완료 시 Admin Completion Queue에 completion queue entry가 post되는지 검증한다 |
| **사전 조건** | Admin Completion Queue 설정됨 |
| **테스트 입력** | Firmware Image Download 명령 실행 |
| **기대 결과** | completion queue entry가 Admin Completion Queue에 post됨 |
| **우선순위** | P1 |

#### TS-FID-024: 성공 시 Status Code 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-019 |
| **시나리오 유형** | Positive |
| **설명** | 명령 성공 시 completion queue entry의 status code가 Success(0x00)인지 검증한다 |
| **사전 조건** | 유효한 명령 파라미터 |
| **테스트 입력** | 정상적인 Firmware Image Download 명령 |
| **기대 결과** | Status Code = 0x00 (Success) |
| **우선순위** | P1 |

### 2.9 중복 업데이트 시퀀스 시나리오

#### TS-FID-025: 단일 업데이트 시퀀스 성공
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-020 |
| **시나리오 유형** | Positive |
| **설명** | 단일 Boot Partition 또는 펌웨어 이미지 업데이트 시퀀스가 성공하는지 검증한다 |
| **사전 조건** | 다른 업데이트 시퀀스 없음 |
| **테스트 입력** | 단일 펌웨어 이미지 다운로드 시퀀스 |
| **기대 결과** | 업데이트 시퀀스 성공 |
| **우선순위** | P2 |

#### TS-FID-026: 중복 업데이트 시퀀스 감지
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-021 |
| **시나리오 유형** | Negative |
| **설명** | 둘 이상의 펌웨어 이미지/Boot Partition 중복 업데이트 명령 시퀀스 감지 시 Dword 0에 결과가 보고되는지 검증한다 |
| **사전 조건** | 첫 번째 업데이트 시퀀스 진행 중 |
| **테스트 입력** | 두 번째 업데이트 시퀀스 시작 시도 |
| **기대 결과** | completion queue entry의 Dword 0에 중복 감지 결과 보고됨 |
| **우선순위** | P2 |

### 2.10 경계값 시나리오

#### TS-FID-027: NUMD 최소값 (0)
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-003 |
| **시나리오 유형** | Boundary |
| **설명** | NUMD = 0일 때 1 dword가 전송되는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | NUMD = 0 |
| **기대 결과** | 1 dword (4 bytes) 전송 |
| **우선순위** | P1 |

#### TS-FID-028: NUMD 최대값 (0xFFFFFFFF)
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-003 |
| **시나리오 유형** | Boundary |
| **설명** | NUMD = 0xFFFFFFFF일 때의 동작을 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | NUMD = 0xFFFFFFFF |
| **기대 결과** | 0x100000000 dwords 전송 요청 (실제 동작은 구현에 따름) |
| **우선순위** | P2 |

#### TS-FID-029: OFST 최소값 (0)
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-004, REQ-FID-005 |
| **시나리오 유형** | Boundary |
| **설명** | OFST = 0일 때 이미지 시작부터 다운로드되는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | OFST = 0 |
| **기대 결과** | 펌웨어 이미지 시작 위치부터 데이터 저장 |
| **우선순위** | P1 |

#### TS-FID-030: OFST 최대값 (0xFFFFFFFF)
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-004 |
| **시나리오 유형** | Boundary |
| **설명** | OFST = 0xFFFFFFFF일 때의 동작을 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | OFST = 0xFFFFFFFF |
| **기대 결과** | 매우 큰 오프셋에서의 동작 (실제 동작은 구현에 따름) |
| **우선순위** | P2 |

#### TS-FID-031: FWUG 경계값 - 정확히 granularity 크기
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-018 |
| **시나리오 유형** | Boundary |
| **설명** | NUMD가 정확히 FWUG granularity 크기일 때 성공하는지 검증한다 |
| **사전 조건** | FWUG = 4KB |
| **테스트 입력** | NUMD = 1023 (정확히 4KB) |
| **기대 결과** | 명령 성공 |
| **우선순위** | P1 |

#### TS-FID-032: FWUG 경계값 - granularity 미만
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-018 |
| **시나리오 유형** | Boundary |
| **설명** | NUMD가 FWUG granularity보다 1 dword 작을 때의 동작을 검증한다 |
| **사전 조건** | FWUG = 4KB |
| **테스트 입력** | NUMD = 1022 (4KB - 1 dword) |
| **기대 결과** | Invalid Field in Command(0x02) 상태 코드 반환 |
| **우선순위** | P2 |

#### TS-FID-033: FWUG 경계값 - granularity 배수
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-018 |
| **시나리오 유형** | Boundary |
| **설명** | NUMD가 FWUG granularity의 정확한 배수일 때 성공하는지 검증한다 |
| **사전 조건** | FWUG = 4KB |
| **테스트 입력** | NUMD = 2047 (정확히 8KB = 2 * 4KB) |
| **기대 결과** | 명령 성공 |
| **우선순위** | P2 |

#### TS-FID-034: OFST alignment 경계값
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-018 |
| **시나리오 유형** | Boundary |
| **설명** | OFST가 FWUG alignment 경계에 정확히 위치할 때 성공하는지 검증한다 |
| **사전 조건** | FWUG = 4KB |
| **테스트 입력** | OFST = 2048 (8KB = 2 * 4KB aligned) |
| **기대 결과** | 명령 성공 |
| **우선순위** | P2 |

### 2.11 오류 처리 시나리오

#### TS-FID-035: 무효한 Data Pointer
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-002 |
| **시나리오 유형** | Negative |
| **설명** | DPTR이 무효한 주소를 가리킬 때 적절한 오류가 반환되는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | DPTR = NULL 또는 무효한 주소 |
| **기대 결과** | 적절한 오류 상태 코드 반환 |
| **우선순위** | P1 |

#### TS-FID-036: 데이터 전송 오류
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-002 |
| **시나리오 유형** | Negative |
| **설명** | 데이터 전송 중 오류 발생 시 적절한 처리가 되는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | 데이터 전송 중 인터럽트 발생 시뮬레이션 |
| **기대 결과** | 적절한 오류 상태 코드 반환 및 상태 복구 |
| **우선순위** | P2 |

#### TS-FID-037: 연속 범위 간 갭 존재 시
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-010 |
| **시나리오 유형** | Negative |
| **설명** | 다운로드된 조각들 사이에 갭이 있을 때의 동작을 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | 조각1: OFST=0, NUMD=1023; 조각2: OFST=2048, NUMD=1023 (갭 존재) |
| **기대 결과** | Firmware Commit 시점에 오류 또는 경고 |
| **우선순위** | P2 |

### 2.12 구조체 검증 시나리오

#### TS-FID-038: CDW10 구조체 크기 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-003 |
| **시나리오 유형** | Positive |
| **설명** | FirmwareImageDownloadCDW10 구조체 크기가 4바이트인지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | sizeof(FirmwareImageDownloadCDW10) |
| **기대 결과** | 크기 = 4 바이트 |
| **우선순위** | P1 |

#### TS-FID-039: CDW11 구조체 크기 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-004 |
| **시나리오 유형** | Positive |
| **설명** | FirmwareImageDownloadCDW11 구조체 크기가 4바이트인지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | sizeof(FirmwareImageDownloadCDW11) |
| **기대 결과** | 크기 = 4 바이트 |
| **우선순위** | P1 |

#### TS-FID-040: CDW10 raw 필드와 bits 필드 동기화
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-003 |
| **시나리오 유형** | Positive |
| **설명** | CDW10의 raw 필드와 bits.NUMD 필드가 동일한 값을 참조하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | raw = 0x12345678 설정 |
| **기대 결과** | bits.NUMD = 0x12345678 |
| **우선순위** | P1 |

#### TS-FID-041: CDW11 raw 필드와 bits 필드 동기화
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-004 |
| **시나리오 유형** | Positive |
| **설명** | CDW11의 raw 필드와 bits.OFST 필드가 동일한 값을 참조하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | raw = 0xABCDEF00 설정 |
| **기대 결과** | bits.OFST = 0xABCDEF00 |
| **우선순위** | P1 |

#### TS-FID-042: Status Code Enum 값 검증
| 항목 | 내용 |
|------|------|
| **관련 요구사항** | REQ-FID-006, REQ-FID-007, REQ-FID-008 |
| **시나리오 유형** | Positive |
| **설명** | FirmwareImageDownloadStatusCode enum 값들이 스펙과 일치하는지 검증한다 |
| **사전 조건** | 없음 |
| **테스트 입력** | enum 값 확인 |
| **기대 결과** | Success=0x00, InvalidFieldInCommand=0x02, OverlappingRange=0x14 |
| **우선순위** | P1 |

---

## 3. 요구사항-시나리오 매핑

| 요구사항 ID | 관련 시나리오 | 커버리지 |
|-------------|---------------|----------|
| REQ-FID-001 | TS-FID-001 | 완료 |
| REQ-FID-002 | TS-FID-002, TS-FID-035, TS-FID-036 | 완료 |
| REQ-FID-003 | TS-FID-003, TS-FID-027, TS-FID-028, TS-FID-038, TS-FID-040 | 완료 |
| REQ-FID-004 | TS-FID-004, TS-FID-029, TS-FID-030, TS-FID-039, TS-FID-041 | 완료 |
| REQ-FID-005 | TS-FID-005, TS-FID-029 | 완료 |
| REQ-FID-006 | TS-FID-006, TS-FID-007, TS-FID-042 | 완료 |
| REQ-FID-007 | TS-FID-008, TS-FID-009, TS-FID-042 | 완료 |
| REQ-FID-008 | TS-FID-010, TS-FID-011, TS-FID-012, TS-FID-042 | 완료 |
| REQ-FID-009 | TS-FID-013 | 완료 |
| REQ-FID-010 | TS-FID-014, TS-FID-037 | 완료 |
| REQ-FID-011 | TS-FID-015 | 완료 |
| REQ-FID-012 | TS-FID-016, TS-FID-017 | 완료 |
| REQ-FID-013 | TS-FID-018 | 완료 |
| REQ-FID-014 | TS-FID-019 | 완료 |
| REQ-FID-015 | TS-FID-020 | 완료 |
| REQ-FID-016 | TS-FID-021, TS-FID-022 | 완료 |
| REQ-FID-017 | TS-FID-010 | 완료 |
| REQ-FID-018 | TS-FID-031, TS-FID-032, TS-FID-033, TS-FID-034 | 완료 |
| REQ-FID-019 | TS-FID-023, TS-FID-024 | 완료 |
| REQ-FID-020 | TS-FID-025 | 완료 |
| REQ-FID-021 | TS-FID-026 | 완료 |

---

## 4. 시나리오 유형별 분류

### 4.1 Positive 시나리오 (18개)

| 시나리오 ID | 설명 | 우선순위 |
|-------------|------|----------|
| TS-FID-001 | Opcode 값 검증 | P1 |
| TS-FID-002 | Data Pointer 필드 설정 검증 | P1 |
| TS-FID-003 | CDW10 NUMD 필드 설정 검증 | P1 |
| TS-FID-004 | CDW11 OFST 필드 설정 검증 | P1 |
| TS-FID-005 | 첫 번째 이미지 조각의 OFST가 0인지 검증 | P1 |
| TS-FID-006 | NUMD가 FWUG 요구사항 충족 시 성공 | P1 |
| TS-FID-008 | OFST가 FWUG 요구사항 충족 시 성공 | P1 |
| TS-FID-010 | 겹치지 않는 범위로 다운로드 성공 | P1 |
| TS-FID-013 | 다른 명령 처리 중 제출 가능 | P1 |
| TS-FID-014 | 여러 조각으로 이미지 다운로드 | P1 |
| TS-FID-015 | 비순차적 조각 다운로드 | P2 |
| TS-FID-016 | Boot Partition 순차 다운로드 성공 | P2 |
| TS-FID-018 | 다운로드만으로 펌웨어 비활성화 검증 | P1 |
| TS-FID-020 | Firmware Commit 후 첫 다운로드 시 기존 조각 폐기 | P1 |
| TS-FID-021 | Controller Level Reset 시 다운로드 조각 폐기 | P1 |
| TS-FID-022 | Reset 후 새 다운로드 시작 | P1 |
| TS-FID-023 | Completion Queue Entry 생성 검증 | P1 |
| TS-FID-024 | 성공 시 Status Code 검증 | P1 |
| TS-FID-025 | 단일 업데이트 시퀀스 성공 | P2 |
| TS-FID-038 | CDW10 구조체 크기 검증 | P1 |
| TS-FID-039 | CDW11 구조체 크기 검증 | P1 |
| TS-FID-040 | CDW10 raw 필드와 bits 필드 동기화 | P1 |
| TS-FID-041 | CDW11 raw 필드와 bits 필드 동기화 | P1 |
| TS-FID-042 | Status Code Enum 값 검증 | P1 |

### 4.2 Negative 시나리오 (16개)

| 시나리오 ID | 설명 | 우선순위 |
|-------------|------|----------|
| TS-FID-007 | NUMD가 FWUG 요구사항 미충족 시 오류 | P1 |
| TS-FID-009 | OFST가 FWUG alignment 미충족 시 오류 | P1 |
| TS-FID-011 | 중복 범위 감지 시 Overlapping Range 오류 | P1 |
| TS-FID-012 | 부분 중복 범위 감지 | P2 |
| TS-FID-017 | Boot Partition 비순차 다운로드 시 오류 | P2 |
| TS-FID-019 | Firmware Commit 없이 새 이미지 다운로드 시 동작 | P1 |
| TS-FID-026 | 중복 업데이트 시퀀스 감지 | P2 |
| TS-FID-035 | 무효한 Data Pointer | P1 |
| TS-FID-036 | 데이터 전송 오류 | P2 |
| TS-FID-037 | 연속 범위 간 갭 존재 시 | P2 |

### 4.3 Boundary 시나리오 (8개)

| 시나리오 ID | 설명 | 우선순위 |
|-------------|------|----------|
| TS-FID-027 | NUMD 최소값 (0) | P1 |
| TS-FID-028 | NUMD 최대값 (0xFFFFFFFF) | P2 |
| TS-FID-029 | OFST 최소값 (0) | P1 |
| TS-FID-030 | OFST 최대값 (0xFFFFFFFF) | P2 |
| TS-FID-031 | FWUG 경계값 - 정확히 granularity 크기 | P1 |
| TS-FID-032 | FWUG 경계값 - granularity 미만 | P2 |
| TS-FID-033 | FWUG 경계값 - granularity 배수 | P2 |
| TS-FID-034 | OFST alignment 경계값 | P2 |

---

## 5. 테스트 데이터 개요

### 5.1 기본 테스트 데이터

| 데이터 항목 | 값 | 설명 |
|-------------|-----|------|
| Opcode | 0x11 | Firmware Image Download opcode |
| NUMD 최소 | 0 | 1 dword 전송 |
| NUMD 표준 | 1023 | 4KB (1024 dwords) 전송 |
| NUMD 최대 | 0xFFFFFFFF | 최대 dword 수 |
| OFST 최소 | 0 | 이미지 시작 위치 |
| OFST 표준 | 1024 | 4KB 오프셋 |
| OFST 최대 | 0xFFFFFFFF | 최대 오프셋 |

### 5.2 FWUG 관련 테스트 데이터

| FWUG 값 | 테스트 NUMD | 테스트 OFST | 예상 결과 |
|---------|-------------|-------------|-----------|
| 4KB (1024 dwords) | 1023 | 0 | 성공 |
| 4KB (1024 dwords) | 511 | 0 | Invalid Field |
| 4KB (1024 dwords) | 1023 | 512 | Invalid Field |
| 4KB (1024 dwords) | 2047 | 1024 | 성공 |

### 5.3 중복 범위 테스트 데이터

| 조각 1 | 조각 2 | 예상 결과 |
|--------|--------|-----------|
| OFST=0, NUMD=1023 | OFST=1024, NUMD=1023 | 성공 (중복 없음) |
| OFST=0, NUMD=2047 | OFST=1024, NUMD=1023 | Overlapping Range |
| OFST=0, NUMD=1023 | OFST=1000, NUMD=1023 | Overlapping Range |

### 5.4 Status Code 테스트 데이터

| Status Code | Value | 테스트 조건 |
|-------------|-------|-------------|
| Success | 0x00 | 정상 명령 완료 |
| Invalid Field in Command | 0x02 | NUMD/OFST FWUG 미충족 |
| Overlapping Range | 0x14 | 중복 범위 감지 |

---

## 6. 미커버 요구사항

현재 모든 요구사항(21개)이 테스트 시나리오로 커버되어 있습니다.

| 요구사항 ID | 상태 | 비고 |
|-------------|------|------|
| REQ-FID-001 ~ REQ-FID-021 | 커버됨 | 모든 요구사항 커버 완료 |

---

## 7. 참고 사항

### 7.1 테스트 환경 요구사항

1. **하드웨어/시뮬레이터**: NVMe 컨트롤러 또는 시뮬레이터
2. **소프트웨어**: NVMe 드라이버, 테스트 프레임워크 (Google Test)
3. **데이터**: 테스트용 펌웨어 이미지 파일

### 7.2 테스트 실행 순서 권장

1. 구조체 검증 시나리오 (TS-FID-038 ~ TS-FID-042)
2. 기본 명령 구조 시나리오 (TS-FID-001 ~ TS-FID-005)
3. 경계값 시나리오 (TS-FID-027 ~ TS-FID-034)
4. FWUG 관련 시나리오 (TS-FID-006 ~ TS-FID-009)
5. 중복 범위 시나리오 (TS-FID-010 ~ TS-FID-012)
6. 다중 조각/동시 처리 시나리오 (TS-FID-013 ~ TS-FID-017)
7. 활성화/폐기 시나리오 (TS-FID-018 ~ TS-FID-022)
8. Completion Queue 시나리오 (TS-FID-023 ~ TS-FID-024)
9. 중복 업데이트 시퀀스 시나리오 (TS-FID-025 ~ TS-FID-026)
10. 오류 처리 시나리오 (TS-FID-035 ~ TS-FID-037)

### 7.3 우선순위별 실행 계획

| 우선순위 | 시나리오 수 | 권장 실행 시점 |
|----------|-------------|----------------|
| P1 | 28개 | 기본 기능 구현 완료 후 즉시 |
| P2 | 14개 | 기본 테스트 통과 후 |

---

## 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 1.0 | 2026-01-13 | Claude | 초기 작성 |
